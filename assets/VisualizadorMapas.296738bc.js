import{k as Ve,d as le,r as x,w as G,H as _,N as E,f as u,J as w,S as at,av as fe,K as st,aw as De,M as m,R as q,Q as de,X as ye,P as H,ax as X,ay as ve,az as _e,aA as ze,V as it,I as ce,ag as nt,F as Se,O as Ce,_ as rt,o as lt,aB as dt,aC as Ee,aD as Re,aE as ct,aF as ut}from"./index.1cf488ee.js";import{M as Ue,f as Le,O as We,L as pt,T as D,S as z,g as je,a as qe,E as O,b as gt,c as L,d as bt,e as ht,D as C,I as mt,h as ft,R as He,i as yt,j as Ke,C as vt,k as ne,l as re,_ as ue,m as V,n as f,o as ke,u as te,p as _t,q as Z,r as oe,s as St,Q as Lt,t as wt,v as $t,B as pe,w as xt,x as Mt,F as Tt,P as Ct,y as Et,z as Rt,A as kt,U as It,G as Ot,H as j,J as At,K as Bt,N as Ft,V as ae,W as Pt,X as ge,Y as Nt,Z as Vt,$ as Dt,a0 as Ie,a1 as K,a2 as zt,a3 as Oe,a4 as Ut,a5 as Wt,a6 as jt,a7 as Ae,a8 as qt,a9 as Ht,aa as Kt,ab as Qt,ac as Xt,ad as Zt,ae as Gt,af as Yt,ag as Jt,ah as eo,ai as to,aj as oo,ak as ao,al as so,am as io,an as no,ao as ro,ap as lo,aq as co,ar as uo,as as po,at as go,au as bo,av as ho}from"./QExpansionItem.891b4d23.js";import{d as mo,Q as fo}from"./dialogoResultadosNominatim.896c3644.js";import{L as we}from"./dialogoBuscadorLugar.59585dc2.js";import{e as yo,f as vo}from"./axios.b375b2b4.js";import"./QImg.2a6b0e0b.js";const Qe=Ve({id:"contextMap",state:()=>({context:typeof Ue}),actions:{setContextMap(c){this.context=c}}}),_o={key:0,class:"flex flex-col justify-center items-center full-width"},So={class:"flex full-width justify-between items-center"},Lo={style:{"font-size":"14px",margin:"auto 0"}},wo={style:{"font-size":"15px","font-width":"bold"}},$o={class:"full-width flex justify-between"},xo=le({__name:"ComponentSearchResults",setup(c){const e=x({}),t=mo(),o=Qe(),a=x(0),s=we(),n={city:12,addresstype:18,road:18,building:18},l=r=>{const d=o.context.getView(),p=e.value.data[r];if(!p)return;const b=Le([parseFloat(p.lon),parseFloat(p.lat)]);d.animate({center:b,zoom:n[p.addresstype],duration:3e3}),s.setShowOverlayBusqueda(!0);const M=new We({positioning:"bottom-center",position:b,element:document.getElementById("overlayBusqueda"),stopEvent:!1});o.context.addOverlay(M)};return G(()=>a.value,r=>{l(r)}),G(()=>t.dataNominatim.data,r=>{e.value.data=r,e.value.data.length>0&&(a.value=0,l(a.value))}),(r,d)=>e.value.data!==void 0&&e.value.data.length>0?(_(),E("div",_o,[u(fe,{style:at(r.$q.screen.xs?{width:"90%",padding:"2px 5px"}:{width:"40%",padding:"2px 5px"})},{default:w(()=>[u(De,{class:"full-width"},{default:w(()=>[m("div",So,[m("p",Lo,q(a.value+1)+" de "+q(e.value.data.length),1),u(de,{flat:"",onClick:d[0]||(d[0]=()=>ye(t).$reset()),rounded:""},{default:w(()=>[u(H,{name:"close"})]),_:1})]),m("p",wo,q(e.value.data[a.value].display_name),1),m("div",$o,[u(de,{color:"light-blue-5",rounded:"",size:"8px",disable:a.value===0,onClick:d[1]||(d[1]=()=>a.value-=1)},{default:w(()=>[u(H,{name:"arrow_back"})]),_:1},8,["disable"]),u(de,{color:"light-blue-5",rounded:"",disable:a.value===e.value.data.length-1,size:"8px",onClick:d[2]||(d[2]=()=>a.value+=1)},{default:w(()=>[u(H,{name:"arrow_forward"})]),_:1},8,["disable"])])]),_:1})]),_:1},8,["style"])])):st("",!0)}}),P="tools.layerTool",g="oltb-toolbox-section",be="oltb-toolbox-list",y="oltb-layer",he="commons",Be="oltb-func-btn";class Mo extends pt{constructor(e={},t){super(e);const o=D.get(P),a=this.button;this.ubicacion=e.ubicacion,a.setAttribute("data-tippy-content",`${o.title} (${z.coordinatesTool})`),a.setAttribute("data-tippy-content-post",`(${z.coordinatesTool})`),a.setAttribute("data-oltb-i18n",`${P}.title`),this.activateTool()}initToolboxHTML(){const e=D.get(`${P}.toolbox`),t=D.get(`${he}.titles`),o=`
            <div id="${y}-toolbox" class="${g}">
                <div class="${g}__header oltb-toggleable" data-oltb-toggleable-target="${y}-map-toolbox-collapsed">
                    <h5 style="font-size: 1.3rem; font-weight: bold" class="${g}__title" data-oltb-i18n="${P}.toolbox.titles.mapLayers">Elige y explora:</h5>
                    <span class="${g}__icon oltb-tippy" data-oltb-i18n="${he}.titles.toggleSection" title="${t.toggleSection}"></span>
                </div>
                <div class="${g}__groups" id="${y}-map-toolbox-collapsed" style="display: ${this.localStorage[`${y}-map-toolbox-collapsed`]?"none":"block"}">
                   <div class="${g}__groups">
                      <select name="select" id="selectEje" class="oltb-input">
                        <option value=96>Zonificaci\xF3n secundaria</option>
                      </select>
                      <div id="buscador-capas"></div>
                    </div>
                    <div id="div-capas" class="${g}__group ${this.options.disableMapCreateLayerButton?`${g}__group--topmost`:""}">
                        <ul id="${y}-map-stack" class="${be}"></ul>
                    </div>
                    <button style="display: none" id="a\xF1adirCapas" type="button" class="oltb-btn oltb-btn--green-mid oltb-w-100">Cargar mas capas</button>
                </div>

                <!-- El display none de este div, no se debe de quitar a menos que se quiera ver las features -->
                <div style="display: none" class="${g}__header oltb-toggleable" data-oltb-toggleable-target="${y}-feature-toolbox-collapsed">
                    <h4 class="${g}__title" data-oltb-i18n="${P}.toolbox.titles.featureLayers">${e.titles.featureLayers}</h4>
                    <span class="${g}__icon oltb-tippy" data-oltb-i18n="${he}.titles.toggleSection" title="${t.toggleSection}"></span>
                </div>
                <div  class="${g}__groups" id="${y}-feature-toolbox-collapsed" style="display: none">
                    <div class="${g}__group">
                        ${this.options.disableFeatureCreateLayerButton?"":`
                                <div class="oltb-input-button-group">
                                    <input type="text" id="${y}-feature-stack-add-text" class="oltb-input" data-oltb-i18n="${P}.toolbox.groups.createFeatureLayer.placeholder" placeholder="${e.groups.createFeatureLayer.placeholder}">
                                    <button type="button" id="${y}-feature-stack-add-button" class="oltb-btn oltb-btn--green-mid oltb-tippy" data-oltb-i18n="${P}.toolbox.groups.createFeatureLayer.create" title="${e.groups.createFeatureLayer.create}">
                                        ${je({path:qe.plus.stroked,width:20,height:20,fill:"none",stroke:"#FFFFFFFF",strokeWidth:1,class:"oltb-btn__icon"})}
                                    </button>
                                </div>
                            `}
                    </div>
                    <div class="${g}__group ${this.options.disableFeatureCreateLayerButton?`${g}__group--topmost`:""}">
                        <ul id="${y}-feature-stack" class="${be} ${be}--selectable"></ul>
                    </div>
                </div>
            </div>

            <div id="contenedor-ubicacion">

            </div>
        `;O.getToolboxElement().insertAdjacentHTML("beforeend",o);const a=document.getElementById("selectEje"),s=document.getElementById("a\xF1adirCapas"),n=we();gt(),a.addEventListener("change",()=>{const l=Number(a.value),r=L.getMapLayers();bt(r,l,this.options.route)}),s.addEventListener("click",async()=>{n.maximoCapas===!0?(s.textContent="Ya no hay mas capas para mostrar",s.disable=!0,s.style="background-color: #adb5bd; border-color: #adb5bd",X.hide()):(X.show(),await n.obtenerMasCapas(),ht(),await X.hide())})}createUIPropertiesButton(e,t,o){const a="Propiedades";return C.createElement({element:"button",class:`${Be} ${Be}--opacity propiedades-btn oltb-tippy`,title:D.get(a),attributes:{type:"button","data-oltb-i18n":a},listeners:{click:this.onLayerProperties.bind(this,e,t,o)}})}onLayerProperties(e,t){this.doProperties(e,t)}doProperties(e,t){this._callback=t;const o=e.getId(),a=`${y}-map-${o}`,s=`${y}-quasar-${o}`,n=document.getElementById(a),l=n.querySelector(".contenedor3"),d=new mt({url:e.layer.sourceChangeKey_.target.urls[0],params:{layer:e.layer.sourceChangeKey_.target.params_.LAYERS,LEGEND_OPTIONS:"forceLabels:on"}}).getLegendUrl(),p="https://mide.monterrey.gob.mx/geoserver/wms/reflect?",b=new URLSearchParams({LAYERS:e.layer.sourceChangeKey_.target.params_.LAYERS,format:"image/png8"}),M=`${p}${b}`;if(l)l.classList&&l.classList.toggle("oculto");else{let A=function(){const W=parseFloat(S.value)/100;e.layer.setOpacity(W),U.innerText=S.value+"%"};n.classList.add("prueba"),n.insertAdjacentHTML("beforeend",`<div class='contenedor3' id=${s}></div>`);const R=ve(ft,{simbologia:d,miniMapa:M,layerid:o});R.use(_e),R.mount(`#${s}`);const S=document.getElementById(`opacity-input-${o}`),U=document.getElementById(`opacity-output-${o}`);S.addEventListener("input",A),A()}}doMapLayerAdded(e){const t=e.detail.isSilent,o=e.detail.layerWrapper,a=e.detail.disableMapLayerOpacityButton||!1;this.createUIMapLayerItem(o,{...!a&&{opacityButton:{function:this.createUIPropertiesButton.bind(this),callback:this.onLayerProperties.bind(this)}}}),!t&&this.options.onMapLayerAdded instanceof Function&&this.options.onMapLayerAdded(o)}}async function To(c){const e=ze();X.show(),yo.get(`${c}`).then(t=>{const o=t.data.map.maplayers;if(t.data.map.keywords.find(a=>a.name.toLowerCase()==="mira")){const a=L.getMapLayers();He(a),o.sort((s,n)=>s.order-n.order),o.forEach(s=>{s.dataset!==null&&yt(s.dataset.title,s.dataset.alternate,s.dataset.links.find(n=>n.link_type==="OGC:WMS").url,!0)})}}).catch(t=>{console.error(t),e.push("/NotFound"),X.hide()})}const se="tools/SplitViewTool.js",ie="oltb-tool-button",v="oltb-toolbox-section",Fe="oltb-slider",Co="oltb-toggleable",h="oltb-split-view",Eo=0,Ro=1,ko=2,T="tools.splitViewTool",Pe="commons",Io=Object.freeze({onInitiated:void 0,onClicked:void 0,onBrowserStateCleared:void 0}),Q=Ke.splitViewTool,me=Object.freeze({isActive:!1,isCollapsed:!1});class Oo extends vt{constructor(e={}){ne.logDebug(se,"constructor","init"),super({element:O.getToolbarElement()});const t=je({path:qe.arrowsExpandVertical.stroked,class:`${ie}__icon`}),o=re.get(T),a=C.createElement({element:"button",html:t,class:ie,attributes:{type:"button","data-tippy-content":`${o.title} (${z.splitViewTool})`,"data-tippy-content-post":`(${z.splitViewTool})`,"data-oltb-i18n":`${T}.title`},listeners:{click:this.onClickTool.bind(this)}});C.appendChildren(this.element,[a]),this.button=a,this.isActive=!1,this.options=ue.merge(ue.cloneDeep(Io),e),this.localStorage=V.getAndMergeStateObject(Q,me),this.initToolboxHTML(),this.initMapHTML(),this.uiRefToolboxSection=document.querySelector(`#${h}-toolbox`),this.initToggleables(),this.uiRefLeftSource=this.uiRefToolboxSection.querySelector(`#${h}-left-source`),this.uiRefLeftSource.addEventListener(f.browser.change,this.updateTool.bind(this)),this.uiRefRightSource=this.uiRefToolboxSection.querySelector(`#${h}-right-source`),this.uiRefRightSource.addEventListener(f.browser.change,this.updateTool.bind(this)),this.uiRefToolboxSection.querySelector(`#${h}-swap-button`).addEventListener(f.browser.click,n=>{this.onSwapLayerSides()}),this.uiRefSplitViewSlider=O.getMapElement().querySelector(`#${h}-slider`),this.uiRefSplitViewSlider.addEventListener(f.browser.input,this.onSliderInput.bind(this)),window.addEventListener(f.browser.keyUp,this.onWindowKeyUp.bind(this)),window.addEventListener(f.custom.ready,this.onOLTBReady.bind(this)),window.addEventListener(f.custom.mapLayerAdded,this.onWindowMapLayerAdded.bind(this)),window.addEventListener(f.custom.mapLayerRemoved,this.onWindowMapLayerRemoved.bind(this)),window.addEventListener(f.custom.browserStateCleared,this.onWindowBrowserStateCleared.bind(this)),this.options.onInitiated instanceof Function&&this.options.onInitiated()}getName(){return se}initToolboxHTML(){const e=re.get(`${T}.toolbox`),t=re.get(`${Pe}.titles`),o=`
            <div id="${h}-toolbox" class="${v}">
                <div class="${v}__header oltb-toggleable" data-oltb-toggleable-target="${h}-toolbox-collapsed">
                    <h4 class="${v}__title" data-oltb-i18n="${T}.toolbox.titles.splitView">${e.titles.splitView}</h4>
                    <span class="${v}__icon oltb-tippy" data-oltb-i18n="${Pe}.titles.toggleSection" title="${t.toggleSection}"></span>
                </div>
                <div class="${v}__groups" id="${h}-toolbox-collapsed" style="display: ${this.localStorage.isCollapsed?"none":"block"}">
                    <div class="${v}__group ${v}__group--split-group">
                        <div class="${v}__group-part">
                            <label class="oltb-label" for="${h}-left-source" data-oltb-i18n="${T}.toolbox.groups.leftSide.title">${e.groups.leftSide.title}</label>
                            <select id="${h}-left-source" class="oltb-select"></select>
                        </div>
                        <div class="${v}__group-part">
                            <label class="oltb-label" for="${h}-source" data-oltb-i18n="${T}.toolbox.groups.rightSide.title">${e.groups.rightSide.title}</label>
                            <select id="${h}-right-source" class="oltb-select"></select>
                        </div>
                    </div>
                    <div class="${v}__group">
                        <button type="button" id="${h}-swap-button" class="oltb-btn oltb-btn--green-mid oltb-w-100" data-oltb-i18n="${T}.toolbox.groups.swapSides.swap">${e.groups.swapSides.swap}</button>
                    </div>
                </div>
            </div>
        `;O.getToolboxElement().insertAdjacentHTML("beforeend",o)}initMapHTML(){O.getMapElement().insertAdjacentHTML("beforeend",`
            <input type="range" min="0" max="100" value="50" class="oltb-slider" id="${h}-slider">
        `)}initToggleables(){this.uiRefToolboxSection.querySelectorAll(`.${Co}`).forEach(e=>{e.addEventListener(f.browser.click,this.onToggleToolbox.bind(this,e))})}onClickTool(e){if(ne.logDebug(se,"onClickTool","User clicked tool"),L.getMapLayerSize()<ko){ke.info({i18nKey:`${T}.toasts.infos.strictOneLayer`});return}this.isActive?this.deactivateTool():this.activateTool(),this.options.onClicked instanceof Function&&this.options.onClicked()}activateTool(){if(this.isActive=!0,this.setDefaultSelectedIndexes().doDispatchChangeEvent(),this.layerLoadingError){this.isActive=!1;return}this.uiRefToolboxSection.classList.add(`${v}--show`),this.uiRefSplitViewSlider.classList.add(`${Fe}--show`),this.button.classList.add(`${ie}--active`),this.localStorage.isActive=!0,V.setStateObject(Q,this.localStorage),this.uiRefToolboxSection.scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"})}deactivateTool(){const e=this.getMap();!e||(te(this.onPreRenderListener),te(this.onPostRenderListener),L.getMapLayers().forEach(t=>{e.removeLayer(t.getLayer())}),L.getMapLayers().forEach(t=>{e.addLayer(t.getLayer())}),L.setTopMapLayerAsOnlyVisible(),this.isActive=!1,this.uiRefToolboxSection.classList.remove(`${v}--show`),this.uiRefSplitViewSlider.classList.remove(`${Fe}--show`),this.button.classList.remove(`${ie}--active`),this.localStorage.isActive=!1,V.setStateObject(Q,this.localStorage))}updateTool(){this.doUpdateTool(this.uiRefLeftSource.value,this.uiRefRightSource.value)}onOLTBReady(e){this.localStorage.isActive&&this.activateTool()}onWindowKeyUp(e){_t(e,z.splitViewTool)&&this.onClickTool(e)}onWindowBrowserStateCleared(){this.doClearState(),this.isActive&&this.deactivateTool(),this.options.onBrowserStateCleared instanceof Function&&this.options.onBrowserStateCleared()}onWindowMapLayerAdded(e){this.doMapLayerAdded(e)}onWindowMapLayerRemoved(e){this.doMapLayerRemoved(e),this.doDispatchChangeEvent()}onToggleToolbox(e){const t=e.dataset.oltbToggleableTarget;this.doToggleToolboxSection(t)}onSwapLayerSides(){this.doSwapLayerSides(),this.doDispatchChangeEvent()}onSliderInput(e){const t=this.getMap();!t||t.render()}onPreRender(e){const t=this.getMap();!t||this.doPreRender(e,t)}onPostRender(e){e.context.restore()}setDefaultSelectedIndexes(){return this.uiRefLeftSource.selectedIndex=String(Ro),this.uiRefRightSource.selectedIndex=String(Eo),this}setLoadingError(){this.layerLoadingError=!0,ne.logError(se,"setLoadingError",{message:"One or both of the layers could not be loaded"}),ke.error({i18nKey:`${T}.toasts.errors.layerFailedToLoad`})}doClearState(){this.localStorage=ue.cloneDeep(me),V.setStateObject(Q,me)}doToggleToolboxSection(e){const t=document.getElementById(e),o=Z.getConfig().animationDuration.fast;t==null||t.slideToggle(o,a=>{this.localStorage.isCollapsed=a,V.setStateObject(Q,this.localStorage)})}doMapLayerRemoved(e){const t=e.detail.layerWrapper;this.uiRefLeftSource.childNodes.forEach(o=>{o.value===t.getId()&&C.removeElement(o)}),this.uiRefRightSource.childNodes.forEach(o=>{o.value===t.getId()&&C.removeElement(o)})}doMapLayerAdded(e){const t=e.detail.layerWrapper,o=C.createElement({element:"option",text:t.getName(),value:t.getId().toString()}),a=C.createElement({element:"option",text:t.getName(),value:t.getId().toString()});C.appendChildren(this.uiRefLeftSource,[o]),C.appendChildren(this.uiRefRightSource,[a])}doPreRender(e,t){const o=e.context,a=t.getSize(),s=Z.getConfig().browser.rem,n=this.uiRefSplitViewSlider.offsetWidth,l=n/2,M=(this.uiRefSplitViewSlider.value/(this.uiRefSplitViewSlider.max-this.uiRefSplitViewSlider.min)*n-l)/l*s,R=a[0],S=a[1],U=R*(this.uiRefSplitViewSlider.value/this.uiRefSplitViewSlider.max)-M,A=oe(e,[U,0]),W=oe(e,[R,0]),Y=oe(e,[U,S]),J=oe(e,[R,S]);o.save(),o.beginPath(),o.moveTo(A[0],A[1]),o.lineTo(Y[0],Y[1]),o.lineTo(J[0],J[1]),o.lineTo(W[0],W[1]),o.closePath(),o.clip()}doSwapLayerSides(){const e=this.uiRefRightSource.value;this.uiRefRightSource.value=this.uiRefLeftSource.value,this.uiRefLeftSource.value=e}doDispatchChangeEvent(){St([this.uiRefLeftSource,this.uiRefRightSource],f.browser.change)}doAddMapLayer(e){e.setVisible(!0),this.getMap().addLayer(e)}doRemoveMapLayer(e){e.setVisible(!1),this.getMap().removeLayer(e)}doUpdateTool(e,t){if(!this.isActive)return;const o=this.getMap();if(!o)return;te(this.onPreRenderListener),te(this.onPostRenderListener),L.getMapLayers().forEach(r=>{this.doRemoveMapLayer(r.getLayer())});const a=L.getMapLayerById(e),s=L.getMapLayerById(t);if(!a||!s){this.setLoadingError();return}const n=a.getLayer(),l=s.getLayer();this.doAddMapLayer(n),e!==t&&(this.doAddMapLayer(l),this.onPreRenderListener=l.on(f.openLayers.preRender,this.onPreRender.bind(this)),this.onPostRenderListener=l.on(f.openLayers.postRender,this.onPostRender.bind(this))),o.render()}}const $="oltb-toolbox-section",I="oltb-split-view",N="tools.splitViewTool",Ne="commons";class Ao extends Oo{constructor(e={}){super(e);const t=D.get(N),o=this.button;o.setAttribute("data-tippy-content",`${t.title} (${z.splitViewTool})`),o.setAttribute("data-tippy-content-post",`(${z.splitViewTool})`),o.setAttribute("data-oltb-i18n",`${N}.title`)}initToolboxHTML(){const e=D.get(`${N}.toolbox`),t=D.get(`${Ne}.titles`),o=`
            <div id="${I}-toolbox" class="${$}">
                <div class="${$}__header oltb-toggleable" data-oltb-toggleable-target="${I}-toolbox-collapsed">
                    <h5 style="font-size: 1.3rem; font-weight: bold" class="${$}__title" data-oltb-i18n="${N}.toolbox.titles.splitView">${e.titles.splitView}</h5>
                    <span class="${$}__icon oltb-tippy" data-oltb-i18n="${Ne}.titles.toggleSection" title="${t.toggleSection}"></span>
                </div>
                <div class="${$}__groups" id="${I}-toolbox-collapsed" style="display: ${this.localStorage.isCollapsed?"none":"block"}">
                    <div class="${$}__group ${$}__group--split-group">
                        <div class="${$}__group-part">
                            <label class="oltb-label" for="${I}-left-source" data-oltb-i18n="${N}.toolbox.groups.leftSide.title">${e.groups.leftSide.title}</label>
                            <select id="${I}-left-source" class="oltb-select"></select>
                        </div>
                        <div class="${$}__group-part">
                            <label class="oltb-label" for="${I}-source" data-oltb-i18n="${N}.toolbox.groups.rightSide.title">${e.groups.rightSide.title}</label>
                            <select id="${I}-right-source" class="oltb-select"></select>
                        </div>
                    </div>
                    <div class="${$}__group">
                        <button type="button" id="${I}-swap-button" class="oltb-btn oltb-btn--green-mid oltb-w-100" data-oltb-i18n="${N}.toolbox.groups.swapSides.swap">${e.groups.swapSides.swap}</button>
                    </div>
                </div>
            </div>
        `;O.getToolboxElement().insertAdjacentHTML("beforeend",o)}}const Xe=Ve({id:"menuUbicacion",state:()=>({features:[],showLoader:!1}),actions:{setFeatures(c){this.features=c},setShowLoader(c){this.showLoader=c}}}),Bo={style:{"margin-top":"10px"}},Fo=le({__name:"ComponenteBuscarCapas",setup(c){const e=x(""),t=()=>{const o=document.getElementById("div-capas");if(!o)return;o.querySelectorAll("li").forEach(s=>{var l;const n=((l=s.textContent)==null?void 0:l.trim().toLowerCase())||"";e.value?s.style.display=n.includes(e.value.toLowerCase())?"flex":"none":s.style.display="flex"})};return G(e,()=>{t()}),(o,a)=>(_(),E("div",Bo,[u(fo,{onSubmit:t},{default:w(()=>[u(it,{"input-style":"font-size: 14px; padding: 25px 10px;",dense:"",label:"Buscar Capas",outlined:"","prepend-icon":"search",modelValue:e.value,"onUpdate:modelValue":a[1]||(a[1]=s=>e.value=s)},{append:w(()=>[u(H,{onClick:a[0]||(a[0]=()=>t()),name:"search",class:"cursor-pointer"})]),_:1},8,["modelValue"])]),_:1})]))}}),Po={class:"full-height"},No={key:0,class:"flex justify-center q-mt-lg full-height"},Vo={key:1},Do={key:0},zo={style:{"margin-top":"1.4rem"}},Uo={style:{"font-family":"Roboto, sans-serif","font-weight":"bold"}},Wo={style:{"font-family":"Roboto, sans-serif"}},jo={style:{"font-family":"Roboto, sans-serif","font-size":"14px"}},qo={key:1,class:"flex justify-center q-mt-lg"},Ho=m("p",null,"No hay informaci\xF3n disponible para este punto",-1),Ko=[Ho],Qo=le({__name:"MenuInfoUbicacion",setup(c){const e=Xe(),t=x(e.features),o=x(e.showLoader),a=x(["fid","y","x","_id","nota","num_inf","area_km","area_ha","fecha_digitalizacion","delegacion_id","distrito_id","id","clave_zonificacion_secundaria","area_m2","area_km2"]),s=n=>Object.keys(n).filter(r=>!a.value.includes(r)).reduce((r,d)=>{const p=d.split("_").map(b=>b.charAt(0).toUpperCase()+b.slice(1)).join(" ");return r[p]=n[d]||"\u2014",r},{});return G(()=>e.features,n=>{t.value=n}),G(()=>e.showLoader,n=>{o.value=n}),(n,l)=>(_(),ce(fe,{flat:"",style:{"margin-top":"1.2rem","margin-bottom":"1.2rem","max-width":"350px",height:"100%"}},{default:w(()=>[m("div",Po,[u(Lt,{"header-style":"padding: 0; margin: 0; font-size: 1.2rem; height: 100%;",label:"Datos de la ubicaci\xF3n"},{default:w(()=>[o.value?(_(),E("div",No,[u(nt,{style:{color:"#3cbae8"},size:"50px"})])):(_(),E("div",Vo,[t.value.length>0?(_(),E("div",Do,[(_(!0),E(Se,null,Ce(t.value,r=>(_(),ce(fe,{flat:"",key:r.id,style:{"border-top":"1px solid lightgrey"}},{default:w(()=>[m("div",zo,[m("p",Uo,q(r.layerName),1)]),(_(!0),E(Se,null,Ce(s(r.propiedades),(d,p)=>(_(),ce(De,{style:{display:"flex","flex-direction":"row",padding:"0","margin-top":".01rem",gap:"3px"},key:p},{default:w(()=>[m("strong",Wo,q(p)+":",1),m("p",jo,q(d||"\u2014"),1)]),_:2},1024))),128))]),_:2},1024))),128))])):(_(),E("div",qo,Ko))]))]),_:1})])]),_:1}))}});const Xo=c=>(ct("data-v-51f1b8bb"),c=c(),ut(),c),Zo={id:"map",class:"mapa",tabindex:"0"},Go=Xo(()=>m("div",{id:"oltb"},null,-1)),Yo={id:"overlay",class:"overlay-marker"},Jo={id:"overlayBusqueda",class:"overlay-marker"},ea=le({__name:"VisualizadorMapas",setup(c){const e=we(),t=wt(),o=$t(),a=x([]);let s=null;ze(),x(["fid","y","x","_id","nota","num_inf","area_km","area_ha","fecha_digitalizacion","delegacion_id","distrito_id"]);const n=x(!0),l=x(!1),r=Xe(),d=Qe();return lt(()=>{dt(()=>{if(t.currentRoute==="/todas-capas"){const b=document.getElementById("buscador-capas");b&&(s=ve(Fo),s.use(_e),s.mount(b)),t.pk="null";const M=L.getMapLayers();He(M),o.loading.show()}else To(t.pk)}),pe.initAsync([{manager:ne},{manager:xt},{manager:Mt},{manager:Tt},{manager:V,options:{ignoredKeys:[]}},{manager:O},{manager:Z},{manager:re},{manager:Ct},{manager:L},{manager:Et},{manager:Rt},{manager:kt},{manager:It},{manager:Ot},{manager:j},{manager:At},{manager:Bt},{manager:Ft}]).then(()=>{p()});const p=()=>{const b=Z.getConfig().location.default,M=Ke.mapData,R=Object.freeze({lon:-100.3001,lat:25.6866,zoom:13,rotation:b.rotation}),S=V.getAndMergeStateObject(M,R),U=new ae({title:" ",type:"base",visible:!0,source:new Pt}),A=new ae({title:" ",type:"base",visible:!1,source:new ge({crossOrigin:"anonymous",url:"https://engine.ec.appsmty.gob.mx/stiles/5ba54d62469b11eebe7f00155d649203/{z}/{x}/{-y}.jpg"})}),W=new ae({title:" ",type:"base",visible:!1,source:new ge({crossOrigin:"anonymous",url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}"})}),Y=new ae({title:" ",type:"base",visible:!1,source:new ge({crossOrigin:"anonymous",url:"https://tile.opentopomap.org/{z}/{x}/{y}.png"})}),J=new Nt({title:"Mapas base",layers:[U,A,W,Y]}),Ze=Z.getConfig().projection.default,B=new Ue({interactions:Vt({mouseWheelZoom:!0,altShiftDragRotate:!1,dragPan:!1,keyboard:!1}).extend([new Dt({condition:function(i){return Ie(i)||j.getSetting(K.mouseWheelZoom)}}),new zt({condition:function(i){return Oe(i)&&j.getSetting(K.altShiftDragRotate)}}),new Ut({condition:function(i){return(Ie(i)||j.getSetting(K.dragPan))&&!Oe(i)&&!Wt(i)}}),new jt({condition:function(i){return j.getSetting(K.keyboardZoom)&&Ae(i)}}),new qt({condition:function(i){return j.getSetting(K.keyboardPan)&&Ae(i)}})]),layers:[J],controls:Ht({zoom:!1,rotate:!1}).extend([new Kt({onAdded:function(i){console.log("HiddenMarkerTool: Marker added",i)},onRemoved:function(i){console.log("HiddenMarkerTool: Marker removed",i)},onEdited:function(i,F){console.log("HiddenMarkerTool: Marker edited",i,F)}}),new Qt({focusZoom:10}),new Xt({lon:29593338145e-4,lat:-111672170009e-4,zoom:10}),new Zt({}),new Gt({}),new Mo({onInitiated:{},ubicacion:l,onClicked:{},onBrowserStateCleared:{},onMapLayerAdded:function(i){},onMapLayerRemoved:function(i){},onMapLayerRenamed:function(i){},onMapLayerVisibilityChanged:function(i){},onMapLayerDragged(i,F){},onFeatureLayerAdded:function(i){},onFeatureLayerRemoved:function(i){},onFeatureLayerRenamed:function(i){},onFeatureLayerVisibilityChanged:function(i){},onFeatureLayerDownloaded:function(i,F,xe){},onFeatureLayerDragged(i,F){}},l),new Yt({onInitiated:{},onClicked:{},onEnter:{},onLeave:{}}),new Jt({color:"#12ABE3",dashed:!0,width:2,showLabels:!0,wrapX:!0,onInitiated:{},onClicked:{},onBrowserStateCleared:{}}),new eo({onInitiated:{},onClicked:{},onReset:function(i){}}),new to({onMapClicked:function(i){}}),new oo({onInitiated:{},onClicked:{},onBrowserStateCleared:{}}),new ao({enableHighAccuracy:!0,timeout:1e4,description:"Esta es la ubicaci\xF3n que el navegador pudo encontrar. Puede que no sea tu ubicaci\xF3n real.",markerLabelUseEllipsisAfter:20,markerLabelUseUpperCase:!1,onInitiated:{},onClicked:{},onLocationFound:function(i){},onError:function(i){}}),new so({isActive:!0,activateTool:{}}),new io({markerLayerVisibleOnLoad:!1,markerLabelUseEllipsisAfter:20,markerLabelUseUpperCase:!1,bookmarks:[{id:"6812cc22-f490-46b7-a9f3-42eb9ea58ac2",name:"Marca personalizada",zoom:5,coordinates:[57.123,16.456]}],onInitiated:{},onClicked:{},onBrowserStateCleared:{},onAdded:{},onRemoved:{},onRenamed:{},onZoomedTo:{},onCleared:{},onDragged:{}}),new Ao({}),new no({filename:"map-image-export",appendTime:!0,onInitiated:{},onClicked:{},onExported:{},onError:{}}),new ro({url:"https://mide.monterrey.gob.mx/#/",target:"_blank",onInitiated:{},onClicked:{}})]),target:O.getMapElement(),view:new lo({projection:co(Ze.code),center:Le([S.lon,S.lat]),zoom:S.zoom,rotation:S.rotation})}),Ge=Le([16.3725,48.208889]),$e=new We({positioning:"bottom-center",position:Ge,element:document.getElementById("overlay"),stopEvent:!1});B.on("click",async function(i){e.setShowOverlayBusqueda(!1),r.setShowLoader(!0);const F=i.coordinate;l.value=!0,$e.setPosition(F);const xe=B.getView().getResolution(),Me=B.getLayers().getArray().filter(k=>k.getVisible()&&k.sourceChangeKey_!=null&&k.sourceChangeKey_.target.params_!=null);if(Me.length===0){e.showOverlay=!1;return}a.value=[];for(const k of Me){const Te=k.sourceChangeKey_.target.params_.LAYERS,Je=uo(Te),et=po(Te,F,xe);try{const ee=await vo.get(`${et}`);ee.data.features.length>0&&(n.value=!0,e.showOverlay=!0,a.value.push(...ee.data.features.map(tt=>{const ot=go(tt.properties);return{layerName:Je.name,propiedades:ot}})))}catch(ee){console.error("Error fetching layer data:",ee)}a.value.length>0?e.showOverlay=!0:e.showOverlay=!1}if(setTimeout(()=>{n.value=!1},500),a.value.length>0){r.setFeatures(a.value);const k=document.getElementById("contenedor-ubicacion");s||(k.style.display="block",s=ve(Qo),s.use(_e),s.mount(k)),r.setShowLoader(!1)}else r.setFeatures(a.value),r.setShowLoader(!1)});const Ye=new bo({reverse:!0,label:"Mapa base"});pe.setMap(B),pe.ready(),B.addControl(Ye),B.addOverlay($e),d.setContextMap(B)}}),(p,b)=>(_(),E(Se,null,[m("div",Zo,[Go,u(xo,{style:{position:"absolute","z-index":"10",bottom:"4rem"}})]),Ee(m("div",Yo,[u(H,{name:"location_on",size:"45px",class:"text-blue"})],512),[[Re,ye(e).showOverlay]]),Ee(m("div",Jo,[u(H,{name:"location_on",size:"45px",class:"text-blue"})],512),[[Re,ye(e).showOverlayBusqueda]]),u(ho)],64))}});var ra=rt(ea,[["__scopeId","data-v-51f1b8bb"]]);export{ra as default};
